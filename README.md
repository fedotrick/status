# Система учета маршрутных карт

Приложение для проверки и обновления информации о маршрутных картах.

## Функциональность

- Проверка наличия бланка по номеру
- Заполнение учетного номера и номера кластера для существующих бланков
- Валидация форматов вводимых данных
- Автоматическое обновление статуса маршрутной карты на "Завершена"
- Просмотр существующих записей в табличном виде
- Поиск по номеру бланка, учетному номеру и номеру кластера
- Обработка ошибок при работе с базой данных
- Информативные подписи для полей ввода
- Расширенная статистика по маршрутным картам

## Особенности интерфейса

- Современный веб-интерфейс на основе Streamlit
- Удобные вкладки для навигации
- Таблицы с возможностью поиска и фильтрации
- Интерактивные графики и диаграммы в разделе статистики
- Увеличенные шрифты для всех элементов интерфейса
- Подсказки в полях ввода для наглядности требуемых форматов
- Цветовое кодирование элементов в зависимости от их назначения
- Информативные сообщения о результатах операций

## Требования

- Python 3.10+
- Streamlit 1.20+
- Pandas 1.5+
- OpenPyXL 3.0+

## Установка

```bash
pip install -r requirements.txt
```

## Запуск приложения

### Запуск приложения Streamlit
```bash
streamlit run app.py
```

После запуска приложение будет доступно в браузере по адресу http://localhost:8501

## Использование

### Вкладка "Редактирование"

1. Введите номер бланка в соответствующее поле и нажмите "Проверить/Обновить"
2. Если бланк найден и поля "Учетный_номер" и "Номер_кластера" пусты, то станут доступны поля для их заполнения
3. Заполните учетный номер в формате ММ-ННН/ГГ (например, 05-002/25)
4. Заполните номер кластера в формате КГГ/ММ-ННН (например, К25/05-099)
5. Нажмите кнопку "Сохранить" для обновления информации в базе данных

После успешного обновления статус маршрутной карты автоматически устанавливается в "Завершена".

### Вкладка "Просмотр данных"

1. Просматривайте существующие записи в табличном виде
2. Используйте поле поиска для фильтрации записей по номеру бланка, учетному номеру или номеру кластера
3. Нажмите кнопку "Обновить данные" для обновления таблицы

### Вкладка "Статистика"

1. Просматривайте общую статистику по маршрутным картам
2. Анализируйте статистику по периодам (день, месяц, год)
3. Изучайте дополнительную статистику по учетным номерам и номерам кластеров
4. Просматривайте графики и диаграммы для лучшего понимания данных

## Валидация форматов

- Учетный номер: ММ-ННН/ГГ (например, 05-002/25)
- Номер кластера: КГГ/ММ-ННН (например, К25/05-099)

## Обработка ошибок

Приложение обрабатывает следующие типы ошибок:
- Ошибки при работе с файлом Excel
- Ошибки при проверке и обновлении данных
- Ошибки валидации формата ввода
- Критические ошибки при запуске приложения

## Тестирование

Для запуска тестов выполните:

```bash
python -m unittest test_app.py
```