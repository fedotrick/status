# Система учета маршрутных карт

Приложение для проверки и обновления информации о маршрутных картах.

## Функциональность

- Проверка наличия бланка по номеру
- Заполнение учетного номера и номера кластера для существующих бланков
- Валидация форматов вводимых данных
- Автоматическое обновление статуса маршрутной карты на "Завершена"
- Просмотр существующих записей в табличном виде
- Поиск по номеру бланка, учетному номеру и номеру кластера
- Обработка ошибок при работе с базой данных
- Информативные подписи для полей ввода
- Быстрое завершение карт нажатием Enter (поддержка USB QR-сканеров)

## Особенности интерфейса

- Современный дизайн с улучшенной цветовой схемой
- Удобные вкладки с визуальным выделением активной
- Таблица с чередующимися цветами строк для лучшей читаемости
- Увеличенные шрифты для всех элементов интерфейса
- Подсказки в полях ввода для наглядности требуемых форматов
- Цветовое кодирование кнопок в зависимости от их назначения
- Информативные всплывающие окна с понятными сообщениями

## Требования

- Python 3.10+
- Kivy 2.0+
- SQLite

## Установка

```bash
pip install kivy
```

## Запуск приложения

### Быстрый запуск на Windows 10

Для удобного запуска на Windows 10 используйте батник:

1. **Первый запуск** (автоматическая настройка окружения):
   ```
   Двойной клик на start.bat
   ```
   При первом запуске автоматически:
   - Создастся виртуальное окружение `.venv`
   - Установятся все зависимости из `requirements.txt`
   - Запустится приложение

2. **Последующие запуски**:
   ```
   Двойной клик на start.bat
   ```
   Или используйте упрощенный вариант:
   ```
   Двойной клик на start_simple.bat
   ```

### Стандартный запуск

```bash
python route_card_app.py
```

### Запуск с указанием пути к базе данных
```bash
python run.py --db путь/к/базе/данных.db
```

## Использование

### Вкладка "Редактирование"

**Завершение маршрутной карты:**

1. Введите номер маршрутной карты (6 цифр, от 000001 до 999999)
2. Нажмите кнопку "Завершить" или просто нажмите **Enter**
3. Система проверит номер и установит статус "Завершена"
4. После успешного завершения поле автоматически очистится, и фокус останется в нем для следующего ввода

**Работа с USB QR-сканером:**
- USB QR-сканер работает как клавиатура
- Сканер автоматически вводит номер и отправляет Enter
- Карта завершается автоматически без необходимости кликать мышкой

**Старый функционал (для справки):**

1. Введите номер бланка в соответствующее поле и нажмите "Проверить/Обновить"
2. Если бланк найден и поля "Учетный_номер" и "Номер_кластера" пусты, то станут доступны поля для их заполнения
3. Заполните учетный номер в формате ММ-ННН/ГГ (например, 05-002/25)
4. Заполните номер кластера в формате КГГ/ММ-ННН (например, К25/05-099)
5. Нажмите кнопку "Сохранить" для обновления информации в базе данных

После успешного обновления статус маршрутной карты автоматически устанавливается в "Завершена".

### Вкладка "Просмотр данных"

1. Просматривайте существующие записи в табличном виде
2. Используйте поле поиска для фильтрации записей по номеру бланка, учетному номеру или номеру кластера
3. Нажмите кнопку "Обновить данные" для обновления таблицы

## Валидация форматов

- Учетный номер: ММ-ННН/ГГ (например, 05-002/25)
- Номер кластера: КГГ/ММ-ННН (например, К25/05-099)

## Обработка ошибок

Приложение обрабатывает следующие типы ошибок:
- Ошибки подключения к базе данных
- Ошибки при проверке и обновлении данных
- Ошибки валидации формата ввода
- Критические ошибки при запуске приложения

## Тестирование

Для запуска тестов выполните:

```bash
python -m unittest test_route_card_app.py
```

## Создание deployment-архива

Для создания архива для развертывания на другом ПК:

### На машине разработчика:

**Способ 1: Через Python**
```bash
python create_deployment.py
```

**Способ 2: Через батник (Windows)**
```
Двойной клик на create_deployment.bat
```

Будет создан архив `Status_v1.0.0_deployment_YYYYMMDD_HHMMSS.zip` содержащий:
- ✅ Все .py файлы проекта
- ✅ requirements.txt
- ✅ README.md и документацию
- ✅ start.bat и start_simple.bat
- ✅ .gitignore
- ✅ Пустую папку data/ (для БД)
- ✅ INSTALL.txt с инструкциями по установке

Архив НЕ содержит:
- ❌ .venv/ (виртуальное окружение)
- ❌ __pycache__/ (кэш Python)
- ❌ .git/ (история git)
- ❌ *.pyc (скомпилированные файлы)
- ❌ *.db (рабочие базы данных)
- ❌ *.xlsx (файлы с данными)
- ❌ .env (секреты)
- ❌ logs/ (логи)

### На целевом ПК:

1. Распакуйте ZIP-архив в любую папку
2. Двойной клик на `start.bat`
3. Приложение автоматически установит зависимости и запустится
4. Скопируйте рабочую базу данных в папку `data/`
